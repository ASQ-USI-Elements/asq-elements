<link rel="import" href="../../components/polymer/polymer.html">
<link rel="import" href="../../components/ace-element/ace-element.html">
<link rel="import" href="../asq-element-conf/asq-element-conf.html">


<polymer-element name="asq-code" attributes="theme mode value readonly wrap fontSize tabSize label">
  <template>
    <style>
      :host {
        display: block;
        /*position: absolute;*/
      }
      .code {
        /*background-color: grey;*/
        display: block;
        position: absolute;

        width: 100%;
        height: 100%;
      }

      #ace {
        display: block;
        position: absolute;
        
        width: 100%;
        height: 100%;
      }

    </style>

    <div class="code">
      <h2>{{label}}</h2>
      <ace-element theme="{{theme}}" mode="{{mode}}" value="{{value}}" readonly="{{readonly}}" wrap="{{wrap}}" fontSize="{{fontSize}}" tabSize="tabSize" id="ace"></ace-element>
    </div>
  </template>

  <script>
    (function () {

      var p = {
        isQuestion_: true,
        type_: "asq-code",

        mode: 'javascript',
        theme: 'monokai',
        readonly: false,
        value: null,
        wrap: false,

        domReady: function  () {
          // console.log("1", this.textContent);
          this.$.ace.value = this.textContent;
          // console.log("2", this.$.ace.value);
        },

        getSubmission: function() {
          if ( this.role !== this.Roles.VIEWER ) {
            return;
          }

          // if ( typeof this.value == 'undefined' ) {
          //   this.value = "";
          // }

          submisstion = "";
          
          return {
            questionId: "",
            timestamp: new Date(),
            submisstion: submisstion
          };
        }
      };

      ASQ.mixin(p, ASQ.ElementType);
      ASQ.mixin(p, ASQ.Role);
      Polymer('asq-code', p);

    })();
    
  </script>
</polymer-element>